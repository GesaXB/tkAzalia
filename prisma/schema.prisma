// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  user_id      Int       @id @default(autoincrement())
  username     String    @unique
  password     String
  role         Role      @default(user)
  nama_lengkap String
  email        String    @unique
  no_telp      String    @unique
  created_at   DateTime  @default(now())
  deleted_at   DateTime?
  siswa        Siswa?
}

enum Role {
  admin
  user
}

model Siswa {
  siswa_id      Int         @id @default(autoincrement())
  user_id       Int         @unique
  status_ppdb   StatusPpdb  @default(menunggu)
  catatan_ppdb  String?
  berkas        BerkasSiswa[]

  user User @relation(fields: [user_id], references: [user_id])
}

enum StatusPpdb {
  menunggu
  lulus
  tidak_lulus
}

model BerkasSiswa {
  berkas_siswa_id  Int            @id @default(autoincrement())
  siswa_id         Int
  jenis_berkas_id  Int
  nama_file        String
  nama_file_hash   String
  path_file        String
  ukuran_file      Int
  tipe_file        String
  status_validasi  StatusValidasi
  catatan_validasi String
  tanggal_unggah   DateTime       @default(now())

  jenisBerkas JenisBerkas @relation(fields: [jenis_berkas_id], references: [jenis_berkas_id])
  siswa       Siswa       @relation(fields: [siswa_id], references: [siswa_id])

  @@unique([siswa_id, jenis_berkas_id])
}

enum StatusValidasi {
  menunggu
  valid
  tidak_valid
}

model JenisBerkas {
  jenis_berkas_id Int           @id @default(autoincrement())
  nama_berkas     String        @unique
  berkas_siswa    BerkasSiswa[]
}

model InformasiSekolah {
  info_id    Int       @id @default(autoincrement())
  judul      String
  slug       String
  konten     String
  tipe       Tipe
  status     Status
  urutan     Int
  created_at DateTime  @default(now())
  uptadet_at DateTime  @default(now())
  deleted_at DateTime?
}

enum Tipe {
  profil
  visi
  misi
  fasilitas
  kontak
  syarat_pendaftaran
}

enum Status {
  draft
  published
}
